<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Contact Card</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="card">

    <div class="header">
      <div class="photo">
        <img id="headshot" alt="Profile photo">
      </div>

      <div class="header-right">
        <div class="header-actions">
          <button class="share-mini" onclick="openShareModal()">Share Profile</button>
        </div>

        <div class="logo">
          <img id="companyLogo" alt="Company logo">
        </div>
      </div>
    </div>

    <div class="name-row">
      <div class="name" id="name"></div>
      <button class="add-contact-btn" onclick="downloadVCard()" aria-label="Add to contacts">
        +
      </button>
    </div>
    <div class="title" id="title"></div>
    <div class="company" id="company"></div>

    <div class="section">
      <a class="item" id="email"></a>
      <a class="item" id="phone"></a>
      <a class="item" id="website"></a>
    </div>

    <button class="cta-btn" id="calendarBtn">
      Book a Calendar Meeting
    </button>

    <div class="socials-wrapper">
      <div class="socials-label">
        <span></span> socials <span></span>
      </div>

      <div class="social-icons">
        <a id="social-linkedin"><img src="linkedin.svg"></a>
        <a id="social-facebook"><img src="facebook.svg"></a>
        <a id="social-instagram"><img src="instagram.svg"></a>
        <a id="social-whatsapp"><img src="whatsapp.svg"></a>
        <a id="social-snapchat"><img src="snapchat.svg"></a>
        <a id="social-letterboxd"><img src="letterboxd.svg"></a>
      </div>
    </div>

  </div>

  <div class="share-modal" id="shareModal" onclick="closeShareModal()">
    <div class="share-modal-content" onclick="event.stopPropagation()">
      <button class="share-close" onclick="closeShareModal()">âœ•</button>
      <h3>Share Profile</h3>

      <div class="qr-wrapper">
        <img id="qrImage" alt="QR Code">
      </div>

      <p class="qr-hint">Scan this QR code to share!</p>

      <button class="share-alt-btn" onclick="shareProfile()">Other ways to share</button>
    </div>
  </div>

  <script>
    const profile = {
      name: "Mason Henderson",
      title: "Director of Data & Financial Operations",
      company: "Snooze Mattress + Wellness",

      email: "mhenderson@snoozesleep.com",
      phone: "+17192147729",
      website: "https://snoozemattresscompany.com",

      calendarUrl: "https://calendar.google.com/appointments/schedules/AcZssZ1Sy1NJqDkSxb78sHIjUj8vk8qJQCKeXpL73XVyg60FHlyQdCgXPvlsYaVt1ogdII6ol3OC0521",

      images: {
        headshot: "headshot-ai.png",
        logo: "snooze-logo.png"
      },

      socials: {
        linkedin: "https://linkedin.com/in/mason-j-henderson",
        facebook: "https://facebook.com/profile.php?id=61551319502785",
        instagram: "https://instagram.com/hendomj213/",
        whatsapp: "https://wa.me/17192147729",
        snapchat: "https://snapchat.com/add/mason_damaster",
        letterboxd: "https://letterboxd.com/Mason_Henderson/"
      },

      shareUrl: "https://hendomj213.github.io/"
    };

    function formatPhone(phone) {
      const digits = phone.replace(/\D/g, "");
      const country = digits.slice(0, 1);
      const area = digits.slice(1, 4);
      const prefix = digits.slice(4, 7);
      const line = digits.slice(7, 11);
      return `+${country} (${area}) ${prefix}-${line}`;
    }

    document.getElementById("name").textContent = profile.name;
    document.getElementById("title").textContent = profile.title;
    document.getElementById("company").textContent = profile.company;

    document.getElementById("headshot").src = profile.images.headshot;
    document.getElementById("companyLogo").src = profile.images.logo;

    const email = document.getElementById("email");
    const phone = document.getElementById("phone");
    const website = document.getElementById("website");
    const shareModal = document.getElementById("shareModal");
    
    email.href = `mailto:${profile.email}`;
    email.textContent = profile.email;
    
    phone.href = `tel:${profile.phone}`;
    phone.textContent = formatPhone(profile.phone);
    
    website.href = profile.website;
    website.textContent = profile.website.replace("https://", "");

    if (!profile.calendarUrl) {
      document.getElementById("calendarBtn").style.display = "none";
    }

    Object.entries(profile.socials).forEach(([key, url]) => {
      const el = document.getElementById(`social-${key}`);
      if (el) el.href = url;
    });

    document.getElementById("qrImage").src =
      `https://api.qrserver.com/v1/create-qr-code/?size=240x240&data=${encodeURIComponent(profile.shareUrl)}`;

    function openShareModal() {
      shareModal.classList.add("active");
    }

    function closeShareModal() {
      shareModal.classList.remove("active");
    }

    function shareProfile() {
  const text = `${profile.name}
${profile.title}
${profile.company}

Phone: ${formatPhone(profile.phone)}
Email: ${profile.email}`;

  if (navigator.share) {
    navigator.share({
      title: profile.name,
      text
    });
  } else {
    location.href =
      `mailto:?subject=${encodeURIComponent(profile.name + " Contact Information")}&body=${encodeURIComponent(text)}`;
  }
}

    function downloadVCard() {
      const vCard = `
BEGIN:VCARD
VERSION:3.0
N:${profile.name.split(" ").reverse().join(";")};;;
FN:${profile.name}
ORG:${profile.company}
TITLE:${profile.title}
TEL;TYPE=CELL:${profile.phone}
EMAIL;TYPE=WORK:${profile.email}
URL:${profile.website}
END:VCARD
      `.trim();

      const blob = new Blob([vCard], { type: "text/vcard" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");

      a.href = url;
      a.download = profile.name.replace(" ", "_") + ".vcf";
      document.body.appendChild(a);
      a.click();

      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    const calendarBtn = document.getElementById("calendarBtn");

    if (profile.calendarUrl) {
      calendarBtn.addEventListener("click", () => {
        window.open(profile.calendarUrl, "_blank", "noopener");
      });
    } else {
      calendarBtn.style.display = "none";
    }

  </script>
</body>
</html>
